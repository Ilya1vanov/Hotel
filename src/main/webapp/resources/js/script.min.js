var link=document.querySelector(".trigger"),popup=document.querySelector(".modal-window"),content=popup.querySelector(".modal-content"),close=popup.querySelector(".modal-content-close"),form=popup.querySelector("form"),nameField=popup.querySelector("#name"),emailField=popup.querySelector("#email"),feedbackField=popup.querySelector("#feedback"),overlay=document.querySelector(".map .overlay"),footer=document.querySelector(".main-footer");if(link&&close&&(link.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("modal-content-show"),nameField.focus()}),close.addEventListener("click",function(e){e.preventDefault(),popup.classList.remove("modal-content-show"),content.classList.remove("modal-content-error")}),window.addEventListener("keydown",function(e){27==e.keyCode&&popup.classList.contains("modal-content-show")&&(popup.classList.remove("modal-content-show"),content.classList.remove("modal-content-error"))})),form&&(form.addEventListener("submit",function(e){if(nameField.value&&emailField.value&&feedbackField.value)for(var o=0,t=popupElements.length;t>o;o++){var n=popupElements[o].getAttribute("name");localStorage.removeItem(n)}else e.preventDefault(),content.classList.remove("modal-content-error"),nameField.focus(),content.classList.add("modal-content-error")}),form&&form.addEventListener("reset",function(){for(var e=0,o=popupElements.length;o>e;e++){var t=popupElements[e].getAttribute("name");localStorage.removeItem(t),nameField.focus()}})),window.localStorage)for(var popupElements=popup.querySelectorAll("[name]"),i=0,length=popupElements.length;length>i;i++)!function(e){var o=e.getAttribute("name");e.value=localStorage.getItem(o)||"",e.onkeyup=function(){localStorage.setItem(o,e.value)}}(popupElements[i]);overlay&&(overlay.addEventListener("click",function(e){overlay.style.pointerEvents="none"}),window.addEventListener("mousemove",function(e){"none"==overlay.style.pointerEvents&&(e.offsetX>overlay.offsetWidth||e.offsetY>overlay.offsetHeight)&&(overlay.style.pointerEvents="auto")}),footer.addEventListener("mouseover",function(){overlay.style.pointerEvents="auto"}));